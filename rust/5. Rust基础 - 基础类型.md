# Rust基础 - 基础类型

Rust 的基础类型包括整数、浮点数、布尔值、字符、数组、元组等。

## 整数

Rust 提供了多种整数类型，包括有符号整数和无符号整数，分别有不同的位数和取值范围。

| 类型    | 有符号 | 位数  | 取值范围                                       |
|-------|-----|-----|--------------------------------------------|
| i8    | ✓   | 8   | -128 ~ 127                                 |
| i16   | ✓   | 16  | -32768 ~ 32767                             |
| i32   | ✓   | 32  | -2147483648 ~ 2147483647                   |
| i64   | ✓   | 64  | -9223372036854775808 ~ 9223372036854775807 |
| i128  | ✓   | 128 |                                            |
| isize | ✓   |     |                                            |
| u8    |     | 8   | 0 ~ 255                                    |
| u16   |     | 16  | 0 ~ 65535                                  |
| u32   |     | 32  | 0 ~ 4294967295                             |
| u64   |     | 64  | 0 ~ 18446744073709551615                   |
| u128  |     | 128 |                                            |
| usize |     |     |                                            |

整数类型默认是有符号的，可以使用 `u` 前缀指定无符号整数类型。

## 浮点数

Rust 提供了两种浮点数类型：`f32` 和 `f64`，分别是单精度浮点数和双精度浮点数。

## 布尔值

Rust 的布尔值类型是 `bool`，只有两个值：`true` 和 `false`。

## 字符

Rust 的字符类型是 `char`，用单引号表示，占用 4 个字节。

## 数组

Rust 的数组类型是 `[T; N]`，其中 `T` 是元素类型，`N` 是数组长度，数组的长度是固定的，不能动态增加或减少。

## 元组

Rust 的元组类型是 `(T1, T2, ...)`，元组可以包含多个不同类型的值，元组的长度是固定的，不能动态增加或减少。

### 空元组

Rust 的空元组类型是 `()`，也称为 unit 类型，它只有一个值，就是 `()`。

## 结构体

Rust 的结构体类型是 `struct`，用于定义自定义的数据类型，结构体可以包含多个字段，每个字段有自己的类型。

## 枚举

Rust 的枚举类型是 `enum`，用于定义一组可能的值，每个值可以有不同的类型。

## 指针

Rust 的指针类型是 `&` 和 `*`，用于引用和解引用，`&` 用于引用，`*` 用于解引用。

## 数组及切片

Rust 的数组类型是 `[T; N]`，数组的长度是固定的，不能动态增加或减少，切片类型是 `&[T]`，切片是对数组的引用，可以动态获取数组的一部分。

## 字符串

Rust 的字符串类型是 `String` 和 `&str`，`String` 是堆上的字符串，`&str` 是字符串切片饮用。

## Option

Rust 的 `Option` 类型是一个枚举类型，用于表示可能有值也可能没有值的情况，`Option` 类型有两个值：`Some` 和 `None`。

## Result

Rust 的 `Result` 类型是一个枚举类型，用于表示可能成功也可能失败的情况，`Result` 类型有两个值：`Ok` 和 `Err`。

## dyn Trait

Rust 的 `dyn Trait` 类型是一个动态 trait 对象，用于在运行时指定 trait 的具体类型，通常用于实现多态。

通常使用 &dyn Trait、&mut dyn Trait 或 Box<dyn Trait> 来创建动态 trait 对象。

## 函数指针

Rust 的函数指针类型是 `fn`，用于指定函数的签名，可以将函数指针作为参数传递给函数，也可以将函数指针作为返回值返回。

```rust
fn add(a: i32, b: i32) -> i32 {
    a + b
}

fn sub(a: i32, b: i32) -> i32 {
    a - b
}

fn calc(op: fn(i32, i32) -> i32, a: i32, b: i32) -> i32 {
    op(a, b)
}
```

## 闭包

Rust 的闭包类型是 `Fn`、`FnMut` 和 `FnOnce`，闭包是一个匿名函数，可以捕获上下文中的变量。

```rust
let add = | a, b| a + b;
let sub = | a, b| a - b;

let x = add(1, 2);
let y = sub(3, 4);
```

## 序列

`x..=y` 表示一个序列，包含起始值和结束值。

```rust
fn main() {
    for i in 1..=5 {
        println!("{}", i);
    }
}
```

## 数字字面量

Rust 的数字字面量支持二进制、八进制、十进制和十六进制表示法。

```rust
fn main() {
    let a = 0b1010; // 二进制
    let b = 0o777;  // 八进制
    let c = 123;    // 十进制
    let d = 0xff;   // 十六进制
}
```

## 字符字面量

Rust 的字符字面量使用单引号表示，占用 4 个字节。

```rust
fn main() {
    let a = 'a';
    let b = '中';
}
```

## 浮点数精度问题

Rust 的浮点数类型是 IEEE754 标准的单精度浮点数和双精度浮点数，浮点数的精度有限，可能会出现精度问题。

```rust
fn main() {
    let a = 0.1 + 0.2;
    println!("{}", a); // 0.30000000000000004
}
```

所以通常在判断浮点数是否相等时，需要使用误差范围。

```rust
fn main() {
    let a = 0.1 + 0.2;
    let b = 0.3;
    let epsilon = 1e-10;
    if (a - b).abs() < epsilon {
        println!("equal");
    } else {
        println!("not equal");
    }
}
```

### NaN

Rust 的浮点数类型支持 NaN（Not a Number）表示非法数值，可以通过 `f32::NAN` 和 `f64::NAN` 来表示 NaN。

```rust
fn main() {
    let a = 0.0 / 0.0;
    println!("{}", a); // NaN
    assert!(a.is_nan());
}
```

## 字符

Rust 的字符类型是 `char`，用单引号表示，占用 4 个字节。

```rust
fn main() {
    let a = 'a';
    let b = '中';
    // emoji
    let c = '😀';
}

// 遍历字符
fn main() {
    for c in '😀'..='😁' {
        println!("{}", c);
    }
}
```

## 类型强制转换

Rust 的类型强制转换使用 `as` 关键字，可以将一个类型转换为另一个类型。

```rust
fn main() {
    let a = 42;
    let b = a as f64;
    println!("{}", b);
}
```
